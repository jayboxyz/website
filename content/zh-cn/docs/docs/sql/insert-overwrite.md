插入覆盖
================

摘要
--------

"```{.none}"
INSERT OVERWRITE [TABLE]表名【（第【,...】】列）查询
```

问题描述
-----------

插入覆盖主要做两件事：1)根据查询创建的数据集删除数据行。2)插入查询产生的新数据。

插入覆盖操作既适用于分区表，也适用于非分区表，但行为不同：

-如果表是非分区表，则直接删除原有数据，再插入新数据。
-如果表是分区表，则只有数据集中存在的来自查询的匹配分区数据才会被删除，并替换为新数据。

如果指定了列名列表，则它们必须与查询生成的列列表完全匹配。表中未在列列表中出现的每个列将用`null`值填充。否则，如果未指定列列表，则查询生成的列必须与要插入的表中的列完全匹配。

示例
--------

假设`orders`不是分区表，有100行，那么在insertwrite语句下面执行：

插入覆盖值排序（1，'SUCCESS'，'10.25'， DATA '2020-01-01'）；

那么`orders`表将只有1行，即`VALUE`子句中指定的数据。

假设`users`有三列：（`id`,`name`,`state`），按`state`分区，现有数据如下行：

---- ------ -------
id名称状态
1张John CD光盘
2山姆光盘
3露西深圳
---- ------ -------

然后执行下面的insertwrite语句：

INSERT OVERWRITE orders VALUES （4, '纽曼'， '光盘'）；

这将用分区值`state='CD'`覆盖数据，但不会影响数据`state='SZ'`。所以结果会是

---- -------- -------
id名称状态
3露西深圳
4纽曼光盘
---- -------- -------

限制
-----------

目前只有Hive连接器支持插入覆盖。

参见
--------

【数值】（./数值），【插入】(./insert.md)
